---

type BlogPost = {
    title: string;
    description: string;
    url: string;
    published_at: string;
};
import Layout from "../layouts/Layout.astro";
const blogUrl = 'https://dev.to/api/articles?username=utkarsh4321';
const response = await fetch(blogUrl);
const blogPosts: BlogPost[] = await response.json();
---



<Layout>
     <section id="blog-posts" class="posts-list">
     {blogPosts.length > 0 ? blogPosts.map(post => (
        <article>
              <h2><a href={post.url} target="_blank" rel="noopener noreferrer">{post.title}</a></h2>
              <p>{post.description}</p>
              <time>{new Date(post.published_at).toLocaleDateString()}</time>
            </article>
     )) : <p>No blog posts found.</p>}
     </section>

  
</Layout>
   <script>
type BlogPost = {
    title: string;
    description: string;
    url: string;
    published_at: string;
};
        const blogUrl = 'https://dev.to/api/articles?username=utkarsh4321';
    // Function to fetch and render blog posts
    async function loadBlogPosts() {
      try {
        const response = await fetch(blogUrl); // Your API endpoint
        if (!response.ok) throw new Error('Failed to fetch');

        const blogPosts: BlogPost[] = await response.json();
        const container = document.getElementById('blog-posts');

        if (container && blogPosts.length > 0) {
          container.innerHTML = blogPosts.map(post => `
            <article>
              <h2><a href="${post.url}" target="_blank" rel="noopener noreferrer">${post.title}</a></h2>
              <p>${post.description}</p>
              <time>${new Date(post.published_at).toLocaleDateString()}</time>
            </article>
          `).join('');
        }
      } catch (error) {
        console.error('Blog fetch error:', error);
        document.getElementById('blog-posts')!.innerHTML = '<p>Failed to load posts.</p>';
      }
    }

    // Run on initial load AND after every client-side navigation to this page
    document.addEventListener('astro:page-load', loadBlogPosts);

    // Optional: Run immediately if needed (in case event already fired)
    loadBlogPosts();
  </script>

<style>
  .posts-list{
    margin:2.5rem 0;
  }
</style>